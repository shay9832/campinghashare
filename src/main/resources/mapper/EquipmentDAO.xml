<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team.mvc.Interface.IEquipmentDAO">
    <!-- 장비코드 생성 -->
    <insert id="insertEquipment" parameterType="com.team.mvc.DTO.EquipmentDTO" statementType="CALLABLE">
        -- 장비 코드 생성
        <selectKey keyProperty="equip_code" resultType="int" order="BEFORE">
            SELECT EQUIP_CODE_SEQ.NEXTVAL FROM DUAL;
        </selectKey>

        -- 생성된 장비 코드를 EQUIP_CODE 테이블에 삽입
        INSERT INTO EQUIP_CODE(EQUIP_CODE) VALUES (#{equip_code})

        -- 장비 등록 테이블에 정보 삽입
        INSERT INTO EQUIPMENT_REGISTRATION(EQUIP_ID, EQUIP_CODE, USER_CODE, CATEGORY_ID, EQUIP_NAME_ID, ORIGINAL_PRICE,
        CREATED_DATE)
        VALUES (EQUIPMENT_REGISTRATION_SEQ.nextval, #{equip_code}, #{user_code}, #{category_id}, #{equip_name_id},
        #{original_price}, SYSDATE)
    </insert>

    <!-- 장비명 ID 조회-->
    <select id="getEquipNameId" resultType="int">
        SELECT EQUIP_NAME_ID
        FROM EQUIP_NAME
        WHERE BRAND_ID = #{brandId}
          AND EQUIP_NAME = #{equipName}
    </select>

</mapper>