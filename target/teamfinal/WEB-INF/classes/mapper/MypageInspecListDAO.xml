<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team.mvc.Interface.IMypageInspecListDAO">
    <resultMap id="InspecResultMap" type="com.team.mvc.DTO.MypageInspecListDTO">
        <result column="거래ID" property="service_id"/>
        <result column="배송ID" property="delivery_id"/>
        <result column="장비코드" property="equip_code"/>
        <result column="검수유형" property="inspec_type"/>
        <result column="장비명" property="equip_name"/>
        <result column="대분류카테명" property="majorCategory"/>
        <result column="중분류카테명" property="middleCategory"/>
        <result column="검수상태" property="inspec_status"/>
        <result column="검수결과장비등급" property="equip_grade"/>
        <result column="검수처리유형이름" property="inspec_result_action_type"/>
        <result column="검수일" property="completed_date"/>
        <result column="유저코드" property="user_code"/>
        <result column="유저닉네임" property="user_nickname"/>
    </resultMap>

    <!-- 해당 회원의 스토렌 입고 검수내역 출력 -->
    <select id="listStorenStoreByUserCode" resultType="com.team.mvc.DTO.MypageInspecListDTO" resultMap="InspecResultMap">
        SELECT "거래ID", "배송ID", "장비코드", "검수유형", "장비명"
             , "대분류카테명", "중분류카테명", "검수상태", "검수결과장비등급"
             , "검수처리유형이름", TO_CHAR("검수일", 'YYYY-MM-DD') AS "검수일", "유저코드", "유저닉네임"
        FROM VW_INSPEC_RESULT_AND_EQUIPMENT
        WHERE "유저코드" = #{user_code} AND "검수유형" = '스토렌_입고검수'
        ORDER BY "거래ID" DESC, "배송ID" DESC
    </select>

    <!-- 해당 회원의 스토렌 반납 검수내역 출력 -->
    <select id="listStorenReturnByUserCode" resultType="com.team.mvc.DTO.MypageInspecListDTO" resultMap="InspecResultMap">
        SELECT "거래ID", "배송ID", "장비코드", "검수유형", "장비명"
             , "대분류카테명", "중분류카테명", "검수상태", "검수결과장비등급"
             , "검수처리유형이름", TO_CHAR("검수일", 'YYYY-MM-DD') AS "검수일", "유저코드", "유저닉네임"
        FROM VW_INSPEC_RESULT_AND_EQUIPMENT
        WHERE "유저코드" = #{user_code} AND "검수유형" = '스토렌_반납검수'
        ORDER BY "거래ID" DESC, "배송ID" DESC
    </select>

    <!-- 해당 회원의 보관 입고 검수내역 출력-->
    <select id="listStorageStoreByUserCode" resultType="com.team.mvc.DTO.MypageInspecListDTO" resultMap="InspecResultMap">
        SELECT "거래ID", "배송ID", "장비코드", "검수유형", "장비명"
             , "대분류카테명", "중분류카테명", "검수상태", "검수결과장비등급"
             , "검수처리유형이름", TO_CHAR("검수일", 'YYYY-MM-DD') AS "검수일", "유저코드", "유저닉네임"
        FROM VW_INSPEC_RESULT_AND_EQUIPMENT
        WHERE "유저코드" = #{user_code} AND "검수유형" = '보관_입고검수'
        ORDER BY "거래ID" DESC, "배송ID" DESC
    </select>

    <!-- id로 스토렌 검색 -->
    <select id="getInspecByStorenId" resultType="com.team.mvc.DTO.MypageInspecListDTO" resultMap="InspecResultMap">
        SELECT "거래ID", "배송ID", "장비코드", "검수유형", "장비명"
             , "대분류카테명", "중분류카테명", "검수상태", "검수결과장비등급"
             , "검수처리유형이름", TO_CHAR("검수일", 'YYYY-MM-DD') AS "검수일", "유저코드", "유저닉네임"
        FROM VW_INSPEC_RESULT_AND_EQUIPMENT
        WHERE "검수유형" LIKE '스토렌%' AND "거래ID" = #{storenId}
        ORDER BY "거래ID" DESC, "배송ID" DESC
    </select>


</mapper>