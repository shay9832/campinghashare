<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team.mvc.Interface.IStorenDAO">
    <!-- 회원코드로 스토렌 장비 리스트 조회 (해당 회원이 가진 스토렌 장비 리스트) -->
    <select id="listByUserCode" resultType="com.team.mvc.DTO.StorenDTO">
        SELECT STOREN_ID, EQUIP_CODE, USER_CODE
             , SIZE_ID, EQUIP_SIZE_NAME, REQUIRED_SPACE
             , DAILY_STORAGE_FEE, STORE_MONTH
             , STOREN_TITLE, STOREN_CONTENT
             , DAILY_RENT_PRICE, CREATED_DATE
        FROM VW_STOREN
        WHERE USER_CODE = #{user_code}
    </select>

    <!-- 유저 코드와 장비 코드로 스토렌 장비 정보 조회 -->
    <select id="listByUserCodeEquipCode" resultType="com.team.mvc.DTO.StorenDTO">
        SELECT STOREN_ID, EQUIP_CODE, USER_CODE
             , SIZE_ID, EQUIP_SIZE_NAME, REQUIRED_SPACE
             , DAILY_STORAGE_FEE, STORE_MONTH
             , STOREN_TITLE, STOREN_CONTENT
             , DAILY_RENT_PRICE, CREATED_DATE
        FROM VW_STOREN
        WHERE USER_CODE = #{user_code} AND EQUIP_CODE = #{equip_code}
    </select>

    <!-- 처음 스토렌 신청했을 때의 스토렌 정보 가져오기-->
    <select id="getStorenByEquipCode" resultType="com.team.mvc.DTO.StorenDTO">
        SELECT *
        FROM (
                 SELECT STOREN_ID, EQUIP_CODE, USER_CODE
                      , SIZE_ID, EQUIP_SIZE_NAME, REQUIRED_SPACE
                      , DAILY_STORAGE_FEE, STORE_MONTH
                      , STOREN_TITLE, STOREN_CONTENT
                      , DAILY_RENT_PRICE, CREATED_DATE
                 FROM VW_STOREN
                 WHERE USER_CODE = #{user_code} AND EQUIP_CODE = #{equip_code}
                 ORDER BY CREATED_DATE ASC
             )
        WHERE ROWNUM = 1
    </select>

</mapper>